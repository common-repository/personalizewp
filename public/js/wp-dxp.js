(()=>{"use strict";const e=[];class t extends HTMLElement{constructor(){super()}connectedCallback(){this.post_id&&this.block_id&&(void 0===e[this.delayed]&&(e[this.delayed]={parsing:!1,elements:[]}),e[this.delayed].elements.push(this))}get post_id(){return this.getAttribute("post-id")}get block_id(){return this.getAttribute("block-id")}get delayed(){let e=this.getAttribute("delayed");return e?Number(e):0}get lifetime(){let e=this.getAttribute("lifetime");return e?Number(e):0}}window.customElements.define("wp-dxp",t);const n=async function(){const t=window.PersonalizeWP;Object.keys(e).forEach((function(o){if(e[o].parsing)return;e[o].parsing=!0;const s=e[o].elements;let i=[];for(let e of s){const{post_id:t,block_id:n}=e;i.push({...t&&{post_id:t},...n&&{block_id:n}})}i.length?t.getBlocks(i,"v1/blocks").then((i=>{if(!Array.isArray(i))throw"No blocks to parse";const c=[];i.forEach((function(e){const t=s.shift();e?c.push([t,e]):t.remove()})),c.length&&setTimeout((function(){c.forEach((function(e){const n=e[0].parentNode;let o=document.createElement("div");if(o.innerHTML=e[1],o=t.utils.nodeScriptReplace(o),e[0].lifetime){const t=1e3*e[0].lifetime,n=o.childNodes;for(const e of n)setTimeout((function(){e.remove()}),t)}e[0].replaceWith(...o.childNodes);const s=new CustomEvent("PWP:parsePlaceholder",{bubbles:!0,cancelable:!0,detail:{container:n}});n.dispatchEvent(s)})),document.dispatchEvent(new CustomEvent("DOMContentLoaded"));const e=new CustomEvent("PWP:parsedPlaceholders",{bubbles:!0,cancelable:!0});document.dispatchEvent(e),n()}),1e3*o),e[o].parsing=!1})).catch((e=>{console.log(e)})):e[o].parsing=!1}))};PersonalizeWP.module("wp-dxp",{populateLegacyPlaceholders:n,ready:function(){this.populateLegacyPlaceholders()}})})();